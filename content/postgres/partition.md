---
title: "分区表"
date: 2020-12-31T10:17:03+08:00
draft: false
---

#### 分区表

数据库分区是一种将数据做物理分片的数据库设计技术，虽然分区技术可以有多种实现方法，

但其主要目的是为了在特定的SQL操作中减少数据读取的总量以缩减响应时间。

#### 分区方式

- 水平分区  

  订单按时间维度  

- 垂直分区

  范式规范 ： 订单数据 （客户表，商品表，订单表）

##### 优点

- 性能 ，范围或点查询。
- 管理 归档，删除
- 统计信息，vacuum

##### 注意事项

- 默认分区
- 索引操作，对字表无效
- 分区键更新
- 主键，唯一键约束。 全局还是子表有效。(唯一键+分区键)

##### 普通表转换为分区表

- pg 版本 < 12 利用pathman 可在线平滑转换
- pg 版本 >=12 原始方式 思路：1 新建一张结构完全相同的表，2 将原表作为新表子表 ，3 修改对换表名 （过程加锁）

[更多](../postgres/book/.pt) 
