---
title: "数据库优化思考 - 模块调优"
date: 2021-01-13T09:04:35+08:00
draft: false
---

##### 开始乱说

主要是结合postgres数据库自身特点，根据具体的业务场景，作出相应调整，使其更加合理。

数据库作为一个整体对外提供服务，单是其内部是由不同的功能模块组成，相互协调来共同完成任务。

各个功能模块完成不同的功能，每个模块的特点也不同，在调整的时候至少需要理解各个模块实现的基本原理（属于内功需修炼）才好下手。

各个功能模块又相互影响，共享资源，也就是他们之间会存在竞争资源。比如当系统发生gc时对几乎各个模块都会产生影响。

有些问题可能是多个模块共同产生的。 最常见的如一条慢sql，可能引起的原因可能是索引不合理，执行计划跑偏，sql本身问题，lock, 当时系统正在gc。等等。

数据库作为一个产品，为了适应更广泛的场景，通常情况下默认设置都比较保守。默认的设置能够在大多数情况下满足的的需求，但是在对性能用所要求的生产环境下需必要的调整，甚至会私人定制。

##### 监测很重要

作用

- 早期发现问题

- 评估调整后效果

工具

- 监控系统

- 日志系统


##### 功能模块概览 

- vacuum

- checkpoint

- sql

- wal

- hotupdate 

- buffer 

- index

- lock


